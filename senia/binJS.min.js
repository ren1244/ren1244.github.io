var binJS={};binJS.s2a_utf8=function(t){var e,n,r,i,a;a=0;for(e=a=0,n=t.length;e<n;++e){r=t.charCodeAt(e);if(r>=55296&&r<=57343){i=t.charCodeAt(++e);r=(r-55296<<10|i-56320)+65536}a+=r<2048?r<128?1:2:r<65536?3:4}var s=new ArrayBuffer(a);var o=new Uint8Array(s);for(e=a=0,n=t.length;e<n;++e){r=t.charCodeAt(e);if(r>=55296&&r<=57343){i=t.charCodeAt(++e);r=(r-55296<<10|i-56320)+65536}if(r<2048){if(r<128){o[a++]=r}else{o[a++]=192|r>>>6&31;o[a++]=128|r&63}}else{if(r<65536){o[a++]=224|r>>>12&15;o[a++]=128|r>>>6&63;o[a++]=128|r&63}else{o[a++]=240|r>>>18&7;o[a++]=128|r>>>12&63;o[a++]=128|r>>>6&63;o[a++]=128|r&63}}}return o};binJS.s2a_base64=function(t){var e,n,r,i,a;for(n=t.length;n>0&&t.charAt(n-1)=="=";--n);a=n&3;if(a==1){console.log("sz_1");return false}a=(n>>>2)*3+(a==0?0:a==2?1:2);var s=new ArrayBuffer(a);var o=new Uint8Array(s);a=0;for(r=e=0;e<n;++e){i=t.charCodeAt(e);if(48<=i&&i<=57)i=i-48+52;else if(65<=i&&i<=90)i=i-65;else if(97<=i&&i<=122)i=i-97+26;else if(i==43)i=62;else if(i==47)i=63;else return false;r=r<<6|i;if((e&3)==1){o[a++]=r>>>4;r&=15}else if((e&3)==2){o[a++]=r>>>2;r&=3}else if((e&3)==3){o[a++]=r;r=0}}return o};binJS.a2s_utf8=function(t){var e=[127,31,15,7];var n=[128,224,240,248];var r=[0,192,224,240];var i="";var a,s,o,f,c;for(a=0,s=t.length;a<s;a+=o+1){f=t[a];o=f<224?f<192?0:1:f<240?2:3;if((f&n[o])!=r[o])return false;f&=e[o];for(j=0;j<o&&a+j+1<s;++j){c=t[a+j+1];if((c&192)!=128)return false;f=f<<6|c&63}if(f>=65536){f-=65536;i+=String.fromCharCode(55296+(f>>>10))+String.fromCharCode(56320+(f&1023))}else{i+=String.fromCharCode(f)}}return i};binJS.a2s_base64=function(t){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var n,r,i,a;var s="";for(n=i=0,r=t.length;n<r;++n){i=i<<8|t[n];if(n%3==0){s+=e[i>>>2];i&=3}else if(n%3==1){s+=e[i>>>4];i&=15}else{s+=e[i>>>6];s+=e[i&63];i=0}}if(n%3==1)s+=e[i<<4]+"==";else if(n%3==2)s+=e[i<<2]+"=";return s};binJS.a2s_hex=function(t){var e=[];for(let n=0;n<t.length;++n)e.push(("00"+t[n].toString(16)).slice(-2));return e.join("")};binJS.s2a_hex=function(t){var e=t.length>>>1;var n=new Uint8Array(e);for(let r=0;r<e;++r)n[r]=parseInt(t.slice(r<<1,(r<<1)+2),16);return n};var sha2=function(){var t="agnmZ/O8yQi7Z66FhMqnOzxu83L+lPgrpU/1Ol8dNvFRDlJ/reaC0ZsFaIwrPmwfH4PZq/tBvWtb4M0ZE34heQ==";var e="QoovmNcoriJxN0SRI+9lzbXA+8/sTTsv6bXbpYGJ27w5VsJb80i1OFnxEfG2BdAZkj+CpK8ZT5urHF7V2m2BGNgHqpijAwJCEoNbAUVwb74kMYW+TuSyjFUMfcPV/7Ticr5ddPJ7iW+A3rH+OxaWsZvcBqclxxI1wZvxdM9pJpTkm2nBnvFK0u++R4Y4TyXjD8GdxouM1bUkDKHMd6ycZS3pLG9ZKwJ1SnSEqm6m5INcsKncvUH71Hb5iNqDEVO1mD5RUu5m36uoMcZtLbQyELADJ8iY+yE/v1l/x77vDuTG4AvzPaiPwtWnkUeTCqclBspjUeADgm8UKSlnCg5ucCe3CoVG0i/8LhshOFwmySZNLG38WsQq7VM4DROdlbPfZQpzVIuvY952agq7PHeyqIHCyS5H7a7mknIshRSCNTuiv+ihTPEDZKgaZku8QjABwkuLcND4l5HHbFGjBlS+MNGS6BnW71IY1pkGJFVlqRD0DjWFV3EgKhBqoHAyu9G4GaTBFrjS0MgeN2wIUUGrUydId0zfjuuZNLC8teGbSKg5HAyzxclaY07YqkrjQYrLW5zKT3dj43NoLm/z1rK4o3SPgu5d77L8eKVjb0MXL2CEyHgUofCrcozHAggaZDnskL7/+iNjHiikUGzr3oK96b75o/eyxnkVxnF48uNyUyvKJz7O6iZhnNGGuMchwMIH6tp91s3g6x71fU9/7m7ReAbwZ6pyF2+6CmN9xaLImKYRP5gEvvkNrhtxCzUTHEcbKNt39SMEfYQyyqt7QMckkzyevgoVyb68Qx1nxJwQDUxMxdS+yz5Ctll/KZz8ZX4qX8tvqzrW+uxsRBmMSkdYFw==";var n="agnmZ7tnroU8bvNypU/1OlEOUn+bBWiMH4PZq1vgzRk=";var r="QoovmHE3RJG1wPvP6bXbpTlWwltZ8RHxkj+CpKscXtXYB6qYEoNbASQxhb5VDH3Dcr5ddIDesf6b3AanwZvxdOSbacHvvkeGD8GdxiQMocwt6SxvSnSEqlywqdx2+YjamD5RUqgxxm2wAyfIv1l/x8bgC/PVp5FHBspjURQpKWcntwqFLhshOE0sbfxTOA0TZQpzVHZqCruBwskuknIshaK/6KGoGmZLwkuLcMdsUaPRkugZ1pkGJPQONYUQaqBwGaTBFh43bAgnSHdMNLC8tTkcDLNO2KpKW5zKT2gub/N0j4LueKVjb4TIeBSMxwIIkL7/+qRQbOu++aP3xnF48g==";var i="y7udXcEFnthimikqNnzVB5FZAVowcN0XFS/s2PcOWTlnMyZn/8ALMY60SodoWBUR2wwuDWT5j6dHtUgdvvpPpA==";var a="jD03yBlUTaJz4ZlmidzU1h36t64y/5yCZ53VFFgvn88PbStpe9RNqHfjb3MExIlCP52FqGodNsgREuatkdaSoQ==";var s="IjEhlPwr9yyfVV+jyExkwiOTuGtvU7FRljh3GVlA6r2WKD7iqI7/475eHiVThjmSKwGZ/CyFuKoOty3cgcUsog==";var o="wQWe2DZ81QcwcN0X9w5ZOf/ACzFoWBURZPmPp776T6Q=";t=binJS.s2a_base64(t);e=binJS.s2a_base64(e);n=binJS.s2a_base64(n);r=binJS.s2a_base64(r);i=binJS.s2a_base64(i);o=binJS.s2a_base64(o);a=binJS.s2a_base64(a);s=binJS.s2a_base64(s);var f={w_and:function(t,e,n,r,i,a){var s=n.getUint32(r<<2)&i.getUint32(a<<2);t.setUint32(e<<2,s)},w_or:function(t,e,n,r,i,a){var s=n.getUint32(r<<2)|i.getUint32(a<<2);t.setUint32(e<<2,s)},w_xor:function(t,e,n,r,i,a){var s=n.getUint32(r<<2)^i.getUint32(a<<2);t.setUint32(e<<2,s)},w_not:function(t,e,n,r){var i=~n.getUint32(r<<2);t.setUint32(e<<2,i)},w_add:function(t,e,n,r,i,a){var s=n.getUint32(r<<2),o=i.getUint32(a<<2);var f=(s&65535)+(o&65535);var c=(s>>>16)+(o>>>16)+(f>>>16);t.setUint32(e<<2,(c&65535)<<16|f&65535)},w_shift:function(t,e,n,r,i){var a=n.getUint32(r<<2)>>>i;t.setUint32(e<<2,a)},w_rotate:function(t,e,n,r,i){var a=n.getUint32(r<<2);t.setUint32(e<<2,a>>>i|a<<32-i)},w_set:function(t,e,n,r){var i=n.getUint32(r<<2);t.setUint32(e<<2,i)},c_sum0:[2,13,22],c_sum1:[6,11,25],c_sig0:[7,18,3],c_sig1:[17,19,10]};var c={w_and:function(t,e,n,r,i,a){var s=n.getUint32(r<<3)&i.getUint32(a<<3),o=n.getUint32((r<<3)+4)&i.getUint32((a<<3)+4);t.setUint32(e<<3,s);t.setUint32((e<<3)+4,o)},w_or:function(t,e,n,r,i,a){var s=n.getUint32(r<<3)|i.getUint32(a<<3),o=n.getUint32((r<<3)+4)|i.getUint32((a<<3)+4);t.setUint32(e<<3,s);t.setUint32((e<<3)+4,o)},w_xor:function(t,e,n,r,i,a){var s=n.getUint32(r<<3)^i.getUint32(a<<3),o=n.getUint32((r<<3)+4)^i.getUint32((a<<3)+4);t.setUint32(e<<3,s);t.setUint32((e<<3)+4,o)},w_not:function(t,e,n,r){var i=~n.getUint32(r<<3),a=~n.getUint32((r<<3)+4);t.setUint32(e<<3,i);t.setUint32((e<<3)+4,a)},w_add:function(t,e,n,r,i,a){var s=n.getUint32(r<<3),o=n.getUint32((r<<3)+4);var f=i.getUint32(a<<3),c=i.getUint32((a<<3)+4);var u=(o&65535)+(c&65535);var w=(o>>>16)+(c>>>16)+(u>>>16);t.setUint32((e<<3)+4,(w&65535)<<16|u&65535);u=(s&65535)+(f&65535)+(w>>>16);w=(s>>>16)+(f>>>16)+(u>>>16);t.setUint32(e<<3,(w&65535)<<16|u&65535)},w_shift:function(t,e,n,r,i){var a=n.getUint32(r<<3),s=n.getUint32((r<<3)+4);if(i<32){t.setUint32(e<<3,a>>>i);t.setUint32((e<<3)+4,a<<32-i|s>>>i)}else{t.setUint32(e<<3,0);t.setUint32((e<<3)+4,a>>>i-32)}},w_rotate:function(t,e,n,r,i){var a=n.getUint32(r<<3),s=n.getUint32((r<<3)+4);if(i<32){t.setUint32(e<<3,s<<32-i|a>>>i);t.setUint32((e<<3)+4,a<<32-i|s>>>i)}else{i-=32;t.setUint32((e<<3)+4,s<<32-i|a>>>i);t.setUint32(e<<3,a<<32-i|s>>>i)}},w_set:function(t,e,n,r){var i=n.getUint32(r<<3),a=n.getUint32((r<<3)+4);t.setUint32(e<<3,i);t.setUint32((e<<3)+4,a)},c_sum0:[28,34,39],c_sum1:[14,18,41],c_sig0:[1,8,7],c_sig1:[19,61,6]};var u={224:{wordSize:4,wordSizePow:2,H0:o,K:r,op:f,outputLen:28},256:{wordSize:4,wordSizePow:2,H0:n,K:r,op:f},512:{wordSize:8,wordSizePow:3,H0:t,K:e,op:c},384:{wordSize:8,wordSizePow:3,H0:i,K:e,op:c,outputLen:48},"512/224":{wordSize:8,wordSizePow:3,H0:a,K:e,op:c,outputLen:28},"512/256":{wordSize:8,wordSizePow:3,H0:s,K:e,op:c,outputLen:32}};return function(t,e){if(!u[t])return false;var n=u[t].wordSize,r=u[t].wordSizePow,i=u[t].H0,a=u[t].K,s=u[t].op;var o=e.length;var f=o+n*20>>>r+4<<r+4;var c=new ArrayBuffer(f);var w=new Uint8Array(c),d=new DataView(c);w.set(e);w[o]=128;w[f-1]=(o&31)<<3;for(let t=1;t<4;++t)w[f-1-t]=o>>>8*t-3&255;var v=i.buffer.slice(),b=new ArrayBuffer(n*8),h=new ArrayBuffer(n*16),g=new ArrayBuffer(a.length);var l=new DataView(v),S=new Uint8Array(v),U=new DataView(b),_=new Uint8Array(b),y=new DataView(h),p=new Uint8Array(h),J=new DataView(a.buffer);dvW=new DataView(g),u8W=new Uint8Array(g);var A=f>>>r+4,x=a.length>>>r;for(let t=0;t<A;++t){_.set(S);for(j=0;j<x;++j){s.w_set(y,0,U,7);s.w_rotate(y,1,U,4,s.c_sum1[0]);s.w_rotate(y,2,U,4,s.c_sum1[1]);s.w_xor(y,1,y,1,y,2);s.w_rotate(y,2,U,4,s.c_sum1[2]);s.w_xor(y,1,y,1,y,2);s.w_add(y,0,y,0,y,1);s.w_and(y,1,U,4,U,5);s.w_not(y,2,U,4);s.w_and(y,2,y,2,U,6);s.w_xor(y,1,y,1,y,2);s.w_add(y,0,y,0,y,1);s.w_add(y,0,y,0,J,j);if(j<16){s.w_set(dvW,j,d,16*t+j)}else{s.w_rotate(y,1,dvW,j-2,s.c_sig1[0]);s.w_rotate(y,2,dvW,j-2,s.c_sig1[1]);s.w_xor(y,1,y,1,y,2);s.w_shift(y,2,dvW,j-2,s.c_sig1[2]);s.w_xor(dvW,j,y,1,y,2);s.w_add(dvW,j,dvW,j,dvW,j-7);s.w_rotate(y,1,dvW,j-15,s.c_sig0[0]);s.w_rotate(y,2,dvW,j-15,s.c_sig0[1]);s.w_xor(y,1,y,1,y,2);s.w_shift(y,2,dvW,j-15,s.c_sig0[2]);s.w_xor(y,1,y,1,y,2);s.w_add(dvW,j,dvW,j,y,1);s.w_add(dvW,j,dvW,j,dvW,j-16)}s.w_add(y,0,y,0,dvW,j);s.w_rotate(y,1,U,0,s.c_sum0[0]);s.w_rotate(y,2,U,0,s.c_sum0[1]);s.w_xor(y,1,y,1,y,2);s.w_rotate(y,2,U,0,s.c_sum0[2]);s.w_xor(y,1,y,1,y,2);s.w_and(y,2,U,0,U,1);s.w_and(y,3,U,0,U,2);s.w_xor(y,2,y,2,y,3);s.w_and(y,3,U,1,U,2);s.w_xor(y,2,y,2,y,3);s.w_add(y,1,y,1,y,2);s.w_set(U,7,U,6);s.w_set(U,6,U,5);s.w_set(U,5,U,4);s.w_add(U,4,U,3,y,0);s.w_set(U,3,U,2);s.w_set(U,2,U,1);s.w_set(U,1,U,0);s.w_add(U,0,y,0,y,1)}for(let t=0;t<8;++t)s.w_add(l,t,l,t,U,t)}if(u[t].outputLen)return S.slice(0,u[t].outputLen);return S;function m(t,e){s.w_shift(t,1,e,2,e,13);s.w_shift(t,0,t,1,e,22)}}}();function hmac_sha2(t,e,n){var r={224:[64,28],256:[64,32],384:[128,48],512:[128,64],"512/224":[128,28],"512/256":[128,32]};if(!r[t])return false;var i=r[t][0],a=r[t][1];if(n.length>i){n=sha2(t,n)}if(n.length<i){let t=new Uint8Array(i);t.set(n);n=t}var s=new Uint8Array(i+a);s.set(n);var o=new Uint8Array(i+e.length);o.set(n);for(let t=0;t<i;++t){s[t]^=92;o[t]^=54}o.set(e,i);var f=sha2(t,o);s.set(f,i);return sha2(t,s)}function AES(t){this.keyInfo=this.getRoundKeys(t)}(function(){var t="Y3x3e/Jrb8UwAWcr/terdsqCyX36WUfwrdSir5ykcsC3/ZMmNj/3zDSl5fFx2DEVBMcjwxiWBZoHEoDi6yeydQmDLBobblqgUjvWsynjL4RT0QDtIPyxW2rLvjlKTFjP0O+q+0NNM4VF+QJ/UDyfqFGjQI+SnTj1vLbaIRD/89LNDBPsX5dEF8Snfj1kXRlzYIFP3CIqkIhG7rgU3l4L2+AyOgpJBiRcwtOsYpGV5HnnyDdtjdVOqWxW9Opleq4IunglLhymtMbo3XQfS72LinA+tWZIA/YOYTVXuYbBHZ7h+JgRadmOlJseh+nOVSjfjKGJDb/mQmhBmS0PsFS7Fg==";var e="Uglq1TA2pTi/QKOegfPX+3zjOYKbL/+HNI5DRMTe6ctUe5QypsIjPe5MlQtC+sNOCC6hZijZJLJ2W6JJbYvRJXL49mSGaJgW1KRczF1ltpJscEhQ/e252l4VRlenjZ2EkNirAIy80wr35FgFuLNFBtAsHo/KPw8Cwa+9AwETims6kRFBT2fc6pfyz87wtOZzlqx0IuetNYXi+TfoHHXfbkfxGnEdKcWJb7diDqoYvhv8Vj5LxtJ5IJrbwP54zVr0H92oM4gHxzGxEhBZJ4DsX2BRf6kZtUoNLeV6n5PJnO+g4DtNrir1sMjruzyDU5lhFysEfrp31ibhaRRjVSEMfQ==";var n=[];n[2]="AAIEBggKDA4QEhQWGBocHiAiJCYoKiwuMDI0Njg6PD5AQkRGSEpMTlBSVFZYWlxeYGJkZmhqbG5wcnR2eHp8foCChIaIioyOkJKUlpianJ6goqSmqKqsrrCytLa4ury+wMLExsjKzM7Q0tTW2Nrc3uDi5Obo6uzu8PL09vj6/P4bGR8dExEXFQsJDw0DAQcFOzk/PTMxNzUrKS8tIyEnJVtZX11TUVdVS0lPTUNBR0V7eX99c3F3dWtpb21jYWdlm5mfnZORl5WLiY+Ng4GHhbu5v72zsbe1q6mvraOhp6Xb2d/d09HX1cvJz83DwcfF+/n//fPx9/Xr6e/t4+Hn5Q==";n[3]="AAMGBQwPCgkYGx4dFBcSETAzNjU8Pzo5KCsuLSQnIiFgY2ZlbG9qaXh7fn10d3JxUFNWVVxfWllIS05NREdCQcDDxsXMz8rJ2Nve3dTX0tHw8/b1/P/6+ejr7u3k5+LhoKOmpayvqqm4u769tLeysZCTlpWcn5qZiIuOjYSHgoGbmJ2el5SRkoOAhYaPjImKq6itrqekoaKzsLW2v7y5uvv4/f739PHy4+Dl5u/s6erLyM3Ox8TBwtPQ1dbf3NnaW1hdXldUUVJDQEVGT0xJSmtobW5nZGFic3B1dn98eXo7OD0+NzQxMiMgJSYvLCkqCwgNDgcEAQITEBUWHxwZGg==";n[9]="AAkSGyQtNj9IQVpTbGV+d5CZgou0vaav2NHKw/z17uc7MikgHxYNBHN6YWhXXkVMq6K5sI+GnZTj6vH4x87V3HZ/ZG1SW0BJPjcsJRoTCAHm7/T9wsvQ2a6nvLWKg5iRTURfVmlge3IFDBceISgzOt3Uz8b58OvilZyHjrG4o6rs5f73yMHa06Sttr+AiZKbfHVuZ1hRSkM0PSYvEBkCC9fexczz+uHon5aNhLuyqaBHTlVcY2pxeA8GHRQrIjkwmpOIgb63rKXS28DJ9v/k7QoDGBEuJzw1QktQWWZvdH2hqLO6hYyXnung+/LNxN/WMTgjKhUcBw55cGtiXVRPRg==";n[11]="AAsWHSwnOjFYU05FdH9iabC7pq2cl4qB6OP+9cTP0tl7cG1mV1xBSiMoNT4PBBkSy8Dd1ufs8fqTmIWOv7Spovb94Ova0czHrqW4s4KJlJ9GTVBbamF8dx4VCAMyOSQvjYabkKGqt7zV3sPI+fLv5D02KyARGgcMZW5zeElCX1T3/OHq29DNxq+kubKDiJWeR0xRWmtgfXYfFAkCMzglLoyHmpGgq7a91N/Cyfjz7uU8NyohEBsGDWRvcnlIQ15VAQoXHC0mOzBZUk9EdX5jaLG6p6ydlouA6eL/9MXO09h6cWxnVl1ASyIpND8OBRgTysHc1+bt8PuSmYSPvrWoow==";n[13]="AA0aFzQ5LiNoZXJ/XFFGS9Ddysfk6f7zuLWir4yBlpu7tqGsj4KVmNPeycTn6v3wa2ZxfF9SRUgDDhkUNzotIG1gd3pZVENOBQgfEjE8Kya9sKeqiYSTntXYz8Lh7Pv21tvMweLv+PW+s6SpioeQnQYLHBEyPyglbmN0eVpXQE3a18DN7uP0+bK/qKWGi5yRCgcQHT4zJClib3h1VltMQWFse3ZVWE9CCQQTHj0wJyqxvKumhYifktnUw87t4Pf6t7qtoIOOmZTf0sXI6+bx/GdqfXBTXklEDwIVGDs2ISwMARYbODUiL2RpfnNQXUpH3NHGy+jl8v+0ua6jgI2alw==";n[14]="AA4cEjg2JCpwfmxiSEZUWuDu/PLY1sTKkJ6MgqimtLrb1cfJ4+3/8ault7mTnY+BOzUnKQMNHxFLRVdZc31vYa2jsb+Vm4mH3dPBz+Xr+fdNQ1FfdXtpZz0zIS8FCxkXdnhqZE5AUlwGCBoUPjAiLJaYioSuoLK85uj69N7QwsxBT11TeXdlazE/LSMJBxUboa+9s5mXhYvR383D6ef1+5qUhoiirL6w6uT2+NLczsB6dGZoQkxeUAoEFhgyPC4g7OLw/tTayMackoCOpKq4tgwCEB40OigmfHJgbkRKWFY3OSslDwETHUdJW1V/cWNt19nLxe/h8/2nqbu1n5GDjQ==";AES.prototype.sbox=binJS.s2a_base64(t);AES.prototype.sbox_r=binJS.s2a_base64(e);var r;for(r in n)n[r]=binJS.s2a_base64(n[r]);AES.prototype.gf_mul=n})();AES.prototype.getRoundKeys=function(t){var e=this.sbox;var n=[];n[16]=4;n[24]=6;n[32]=8;var r=[];r[16]=10;r[24]=12;r[32]=14;var i=n[t.length];var a=r[t.length];var s=new Uint8Array(16*(a+1));var o,f=[1,2,4,8,16,32,64,128,27,54],c=0;for(o=0;o<i*4;++o)s[o]=t[o];for(o=i;o<4*(a+1);++o){if(o%i==0){s[o*4]=s[(o-i)*4]^(e[s[o*4-3]]^f[c++]);s[o*4+1]=s[(o-i)*4+1]^e[s[o*4-2]];s[o*4+2]=s[(o-i)*4+2]^e[s[o*4-1]];s[o*4+3]=s[(o-i)*4+3]^e[s[o*4-4]]}else if(i>6&&o%i==4){s[o*4]=s[(o-i)*4]^e[s[o*4-4]];s[o*4+1]=s[(o-i)*4+1]^e[s[o*4-3]];s[o*4+2]=s[(o-i)*4+2]^e[s[o*4-2]];s[o*4+3]=s[(o-i)*4+3]^e[s[o*4-1]]}else{s[o*4]=s[(o-i)*4]^s[o*4-4];s[o*4+1]=s[(o-i)*4+1]^s[o*4-3];s[o*4+2]=s[(o-i)*4+2]^s[o*4-2];s[o*4+3]=s[(o-i)*4+3]^s[o*4-1]}}return{nr:a,rk:s}};AES.prototype.subBytes=function(t,e,n){var r;for(r=0;r<16;++r)t[e+r]=n[t[e+r]]};AES.prototype.shiftRows=function(t,e,n){var r,i,a;for(r=1;r<4;++r){i=t[e+r]<<24|t[e+r+4]<<16|t[e+r+8]<<8|t[e+r+12];i=i<<n*r%32|i>>>(32-n)*r%32;t[e+r]=i>>>24&255;t[e+r+4]=i>>>16&255;t[e+r+8]=i>>>8&255;t[e+r+12]=i&255}};AES.prototype.mixColumns=function(t,e,n){var r,i,a=[];var s=this.gf_mul;if(n==1){for(r=0;r<16;r+=4){for(i=0;i<4;++i)a[i]=t[e+r+i];t[e+r]=s[2][a[0]]^s[3][a[1]]^a[2]^a[3];t[e+r+1]=a[0]^s[2][a[1]]^s[3][a[2]]^a[3];t[e+r+2]=a[0]^a[1]^s[2][a[2]]^s[3][a[3]];t[e+r+3]=s[3][a[0]]^a[1]^a[2]^s[2][a[3]]}}else{for(r=0;r<16;r+=4){for(i=0;i<4;++i)a[i]=t[e+r+i];t[e+r]=s[14][a[0]]^s[11][a[1]]^s[13][a[2]]^s[9][a[3]];t[e+r+1]=s[9][a[0]]^s[14][a[1]]^s[11][a[2]]^s[13][a[3]];t[e+r+2]=s[13][a[0]]^s[9][a[1]]^s[14][a[2]]^s[11][a[3]];t[e+r+3]=s[11][a[0]]^s[13][a[1]]^s[9][a[2]]^s[14][a[3]]}}};AES.prototype.addRoundKey=function(t,e,n,r){for(i=0;i<16;++i)t[e+i]^=n[r+i]};AES.prototype.chiper=function(t,e){var n=this.keyInfo.rk;var r=this.keyInfo.nr;this.addRoundKey(t,e,n,0);var i;for(i=1;i<r;++i){this.subBytes(t,e,this.sbox);this.shiftRows(t,e,8);this.mixColumns(t,e,1);this.addRoundKey(t,e,n,16*i)}this.subBytes(t,e,this.sbox);this.shiftRows(t,e,8);this.addRoundKey(t,e,n,16*i)};AES.prototype.invChiper=function(t,e){var n=this.keyInfo.rk;var r=this.keyInfo.nr;this.addRoundKey(t,e,n,r*16);this.shiftRows(t,e,24);this.subBytes(t,e,this.sbox_r);var i;for(i=r-1;i>0;--i){this.addRoundKey(t,e,n,16*i);this.mixColumns(t,e,-1);this.shiftRows(t,e,24);this.subBytes(t,e,this.sbox_r)}this.addRoundKey(t,e,n,0)};binJS.random_iv=function(){var t,e=new Uint8Array(16);for(t=0;t<16;++t)e[t]=Math.random()*256|0;return e};binJS.pad={};binJS.pad.zero={};binJS.pad.zero.enc=function(t){var e=new Uint8Array(((t.length+15)/16|0)*16);e.set(t);return e};binJS.pad.zero.dec=function(t){return t};binJS.pad.pkcs7={};binJS.pad.pkcs7.enc=function(t){var e=new Uint8Array(((t.length+16)/16|0)*16);e.set(t);e.fill(e.length-t.length,t.length);return e};binJS.pad.pkcs7.dec=function(t){var e=t[t.length-1];return t.slice(0,t.length-e)};binJS.aes_cbc_enc=function(t,e,n,r){if(!r){r=binJS.pad.pkcs7}var i=new AES(e);var a=r.enc(t);var s,o,f=a.length/16;for(o=0;o<16;++o)a[o]^=n[o];i.chiper(a,0);for(s=1;s<f;++s){for(o=0;o<16;++o)a[s*16+o]^=a[(s-1)*16+o];i.chiper(a,s*16)}return a};binJS.aes_cbc_dec=function(t,e,n,r){if(!r){r=binJS.pad.pkcs7}var i=new AES(e);var a=t.slice();var s,o;for(s=a.length-16;s>0;s-=16){i.invChiper(a,s);for(o=0;o<16;++o)a[s+o]^=a[s-16+o]}i.invChiper(a,0);for(o=0;o<16;++o)a[o]^=n[o];return r.dec(a)};String.prototype.bin=function(t){if(!t)t="utf8";return{utf8:binJS.s2a_utf8,base64:binJS.s2a_base64,hex:binJS.s2a_hex}[t].call(null,this)};Uint8Array.prototype.str=function(t){if(!t)t="utf8";return{utf8:binJS.a2s_utf8,base64:binJS.a2s_base64,hex:binJS.a2s_hex}[t].call(null,this)};if(window.sha2){Uint8Array.prototype.sha2=function(t){return sha2(t,this)};Uint8Array.prototype.hmac_sha2=function(t,e){if(typeof e==="string")e=e.bin("utf8");return hmac_sha2(t,this,e)};String.prototype.hmac_sha2=function(t,e){if(typeof e==="string")e=e.bin("utf8");return hmac_sha2(t,this.bin("utf8"),e)}}if(binJS.aes_cbc_enc&&binJS.aes_cbc_dec){Uint8Array.prototype.cipher=function(t,e,n){return{aes_cbc_zero:binJS.aes_cbc_enc,aes_cbc_pkcs7:binJS.aes_cbc_enc}[t].apply(null,[this,e,n,{aes_cbc_zero:binJS.pad.zero,aes_cbc_pkcs7:binJS.pad.pkcs7}[t]])};Uint8Array.prototype.decipher=function(t,e,n){return{aes_cbc_zero:binJS.aes_cbc_dec,aes_cbc_pkcs7:binJS.aes_cbc_dec}[t].apply(null,[this,e,n,{aes_cbc_zero:binJS.pad.zero,aes_cbc_pkcs7:binJS.pad.pkcs7}[t]])}}